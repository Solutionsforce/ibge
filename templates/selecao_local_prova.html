<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confirmação do Local da Prova - IBGE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        @import url('https://fonts.cdnfonts.com/css/rawline');

        body {
            font-family: 'Rawline', sans-serif;
            background-color: #f8f9fa;
        }

        /* Fix mobile layout */
        @media (max-width: 768px) {
            body {
                min-height: 100vh;
                display: flex;
                flex-direction: column;
            }
            
            .main-content {
                flex: 1;
                background: #f8f9fa;
            }
        }

        .content-overlay {
            position: relative;
            z-index: 5;
            background: transparent;
        }

        /* Estilo para inputs */
        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 8px;
            cursor: pointer;
        }

        /* Botões */
        .btn-primary {
            background-color: #1d4ed8;
            color: white;
            padding: 12px 24px;
            border-radius: 6px;
            font-weight: 600;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
        }

        .btn-primary:hover {
            background-color: #1e40af;
            transform: translateY(-1px);
        }

        .btn-primary:disabled {
            background-color: #94a3b8;
            cursor: not-allowed;
            transform: none;
        }

        /* Checkbox customizado */
        .custom-checkbox {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #d1d5db;
            border-radius: 4px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
        }

        .custom-checkbox:checked {
            background-color: #1d4ed8;
            border-color: #1d4ed8;
        }

        .custom-checkbox:checked::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 12px;
        }

        /* Animações */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <!-- Gov.br Bar -->
    <div class="bg-[#0C326F] text-white py-1 px-4 text-xs content-overlay">
        <div class="flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <a href="https://www.gov.br" class="hover:underline">Portal do Governo Brasileiro</a>
                <a href="https://www.gov.br/pt-br/noticias" class="hover:underline">Notícias</a>
                <a href="https://www.gov.br/servicos" class="hover:underline">Serviços</a>
                <a href="https://www.gov.br/legislacao" class="hover:underline">Legislação</a>
            </div>
            <div class="flex items-center space-x-4">
                <a href="https://www.gov.br/acessibilidade" class="hover:underline">Acessibilidade</a>
                <a href="https://www.gov.br/fale-conosco" class="hover:underline">Fale Conosco</a>
                <a href="https://www.gov.br/centrais-de-conteudo" class="hover:underline">Centrais de Conteúdo</a>
            </div>
        </div>
    </div>

    <!-- IBGE logo and language -->
    <div class="w-full flex flex-col items-center pt-6 pb-2 bg-white content-overlay">
        <img alt="IBGE logo azul, texto e símbolo geométrico em fundo transparente" class="mb-2" src="https://www.ibge.gov.br/templates/novo_portal_base/imagens/logo_mobile.png" style="width:125px; height:24px;"/>
        <div class="relative">
            <div class="flex items-center space-x-2 mt-1 cursor-pointer hover:bg-gray-50 px-2 py-1 rounded transition-colors" id="language-selector">
                <img alt="Brazilian flag" class="w-6 h-5 rounded shadow-sm border border-gray-200" src="https://www.ibge.gov.br/templates/novo_portal_base/imagens/pt_br.png"/>
                <div class="h-7 w-px bg-gray-300 mx-1"></div>
                <img alt="Globe icon for language selection" class="w-6 h-6" src="https://www.ibge.gov.br/media/mod_gtranslate/flags/svg/globe.svg"/>
                <span class="text-[#444] text-sm font-normal">
                    Outros idiomas
                </span>
                <i class="fas fa-chevron-down text-gray-500 ml-1 text-xs transition-transform duration-200" id="language-chevron"></i>
            </div>
        </div>
    </div>

    <!-- Instituto name line -->
    <div class="bg-white border-t border-gray-200 content-overlay">
        <div class="py-2">
            <p class="text-gray-700 text-sm text-center">Instituto Brasileiro de Geografia e Estatística</p>
        </div>
    </div>

    <!-- Marca d'água com overlay -->
    <div class="fixed inset-0 pointer-events-none overflow-hidden" style="z-index: 1;">
        <div class="absolute select-none" 
             style="top: 50%; left: 0; right: 0; transform: translateY(-50%) rotate(25deg); transform-origin: center;">
            <img src="https://logodownload.org/wp-content/uploads/2018/02/ibge-logo.png" 
                 alt="IBGE Watermark" 
                 class="opacity-25 w-full h-auto max-w-none"
                 style="filter: grayscale(40%); width: 90vw; margin-left: -5vw;">
        </div>
    </div>

    <div class="main-content">
        <div class="container mx-auto px-4 py-8 relative content-overlay" style="z-index: 5;">
            <div class="max-w-4xl mx-auto space-y-6">
                <!-- Cabeçalho do Formulário -->
                <section class="bg-white border border-gray-300 shadow-sm fade-in">
                    <div class="bg-[#0B2341] text-white px-6 py-4">
                        <div class="flex items-center">
                            <img src="https://www.ibge.gov.br/templates/novo_portal_base/imagens/logo_mobile.png" alt="IBGE" class="h-8 mr-4 filter brightness-0 invert">
                            <div>
                                <h1 class="text-xl font-bold">PROCESSO SELETIVO SIMPLIFICADO IBGE 2025</h1>
                                <p class="text-sm text-gray-200">EDITAL Nº 001/2025 - CONFIRMAÇÃO DO LOCAL DA PROVA</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-[#184A8C] text-white px-6 py-3">
                        <p class="text-sm font-medium">CONFIRMAÇÃO DO LOCAL DE APLICAÇÃO DAS PROVAS</p>
                        <p class="text-xs text-gray-200">Verifique seu endereço e confirme o envio das informações por e-mail</p>
                    </div>
                </section>

                <!-- Endereço do Usuário -->
                <section class="bg-white border border-gray-300 shadow-sm fade-in">
                    <div class="bg-gray-100 border-b border-gray-300 px-6 py-3">
                        <h2 class="text-lg font-bold text-gray-800">
                            <i class="fas fa-map-marker-alt mr-2 text-blue-600"></i>
                            SEU ENDEREÇO DE RESIDÊNCIA
                        </h2>
                        <p class="text-sm text-gray-600 mt-1">Endereço utilizado para definir o local de prova mais próximo</p>
                    </div>

                    <div class="p-6">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                            <h3 class="font-semibold text-blue-900 mb-3">
                                <i class="fas fa-home mr-2"></i>
                                Endereço Confirmado
                            </h3>
                            <p class="text-blue-800 text-lg font-medium mb-2" id="endereco-completo-display">
                                Carregando endereço...
                            </p>
                            <div class="text-sm text-blue-700 space-y-1" id="endereco-detalhes">
                                <div class="flex items-center">
                                    <i class="fas fa-envelope mr-2"></i>
                                    <span>CEP: <span id="cep-display">-</span></span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-city mr-2"></i>
                                    <span id="cidade-uf-display">-</span>
                                </div>
                            </div>
                        </div>

                        <!-- Informações sobre o local da prova -->
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                            <h3 class="font-semibold text-yellow-900 mb-3">
                                <i class="fas fa-info-circle mr-2"></i>
                                Informações Importantes
                            </h3>
                            <ul class="text-yellow-800 space-y-2 text-sm">
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle mr-2 mt-1 text-green-600"></i>
                                    <span>O local da prova será determinado automaticamente com base no seu endereço de residência</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-envelope mr-2 mt-1 text-blue-600"></i>
                                    <span>Você receberá as informações completas do local por e-mail</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-calendar-alt mr-2 mt-1 text-purple-600"></i>
                                    <span>As informações serão enviadas com <strong>7 dias úteis de antecedência</strong> da data da prova</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-map-marker-alt mr-2 mt-1 text-red-600"></i>
                                    <span>Será selecionado o local mais próximo e adequado ao seu endereço</span>
                                </li>
                            </ul>
                        </div>

                        <!-- Termo de Concordância -->
                        <div class="bg-gray-50 border border-gray-300 rounded-lg p-6">
                            <h3 class="font-semibold text-gray-900 mb-4">
                                <i class="fas fa-clipboard-check mr-2"></i>
                                Termo de Concordância
                            </h3>
                            
                            <div class="space-y-4">
                                <div class="border-l-4 border-blue-500 pl-4 py-2 bg-white">
                                    <p class="text-gray-700 text-sm leading-relaxed">
                                        <strong>Declaro que estou ciente e concordo com as seguintes condições:</strong>
                                    </p>
                                </div>

                                <div class="space-y-3">
                                    <label class="flex items-start cursor-pointer group">
                                        <input type="checkbox" class="custom-checkbox flex-shrink-0 mt-1" id="concordo-endereco" required>
                                        <span class="text-sm text-gray-700 ml-3 group-hover:text-gray-900">
                                            Confirmo que o endereço de residência apresentado está correto e atualizado
                                        </span>
                                    </label>

                                    <label class="flex items-start cursor-pointer group">
                                        <input type="checkbox" class="custom-checkbox flex-shrink-0 mt-1" id="concordo-email" required>
                                        <span class="text-sm text-gray-700 ml-3 group-hover:text-gray-900">
                                            Concordo em receber as informações do local da prova por e-mail no endereço cadastrado
                                        </span>
                                    </label>

                                    <label class="flex items-start cursor-pointer group">
                                        <input type="checkbox" class="custom-checkbox flex-shrink-0 mt-1" id="concordo-prazo" required>
                                        <span class="text-sm text-gray-700 ml-3 group-hover:text-gray-900">
                                            Estou ciente que as informações serão enviadas com 7 (sete) dias úteis de antecedência da prova
                                        </span>
                                    </label>

                                    <label class="flex items-start cursor-pointer group">
                                        <input type="checkbox" class="custom-checkbox flex-shrink-0 mt-1" id="concordo-local" required>
                                        <span class="text-sm text-gray-700 ml-3 group-hover:text-gray-900">
                                            Aceito que o local da prova seja determinado automaticamente com base no endereço de residência mais próximo
                                        </span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Botão de Confirmação -->
                        <div class="mt-8 text-center">
                            <button type="button" 
                                    class="btn-primary text-lg px-8 py-4 disabled:opacity-50" 
                                    id="btn-confirmar-local"
                                    disabled>
                                <i class="fas fa-check-circle mr-2"></i>
                                Confirmar Local da Prova
                            </button>
                            <p class="text-sm text-gray-600 mt-3">
                                Ao confirmar, você será direcionado para o checkout de pagamento
                            </p>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Carregar dados do localStorage
            loadUserData();
            
            // Configurar event listeners para checkboxes
            setupCheckboxListeners();
            
            // Configurar botão de confirmação
            setupConfirmButton();
        });

        function loadUserData() {
            console.log('=== CARREGANDO DADOS DO USUÁRIO ===');
            
            // Tentar carregar dados completos primeiro
            let userData = {};
            try {
                const storedData = localStorage.getItem('ibge_inscricao_dados_completos');
                if (storedData) {
                    userData = JSON.parse(storedData);
                    console.log('✓ Dados completos carregados:', userData);
                } else {
                    console.log('⚠ Dados completos não encontrados, carregando seções individuais');
                    // Carregar seções individuais
                    const secao3 = localStorage.getItem('ibge_inscricao_secao3');
                    if (secao3) {
                        const enderecoData = JSON.parse(secao3);
                        userData.endereco = enderecoData;
                        console.log('✓ Dados da seção 3 carregados:', enderecoData);
                    }
                }
            } catch (error) {
                console.error('Erro ao carregar dados:', error);
            }

            // Exibir endereço
            displayAddress(userData.endereco || {});
        }

        function displayAddress(endereco) {
            const enderecoDisplay = document.getElementById('endereco-completo-display');
            const cepDisplay = document.getElementById('cep-display');
            const cidadeUfDisplay = document.getElementById('cidade-uf-display');

            if (endereco.logradouro) {
                let enderecoCompleto = endereco.logradouro;
                if (endereco.numero) enderecoCompleto += ', ' + endereco.numero;
                if (endereco.complemento) enderecoCompleto += ', ' + endereco.complemento;
                if (endereco.bairro) enderecoCompleto += ', ' + endereco.bairro;
                
                enderecoDisplay.textContent = enderecoCompleto;
                cepDisplay.textContent = endereco.cep || '-';
                cidadeUfDisplay.textContent = (endereco.cidade || '') + (endereco.uf ? ' - ' + endereco.uf : '');
            } else {
                enderecoDisplay.textContent = 'Endereço não disponível';
                cepDisplay.textContent = '-';
                cidadeUfDisplay.textContent = '-';
            }
        }

        function setupCheckboxListeners() {
            const checkboxes = document.querySelectorAll('.custom-checkbox');
            const confirmButton = document.getElementById('btn-confirmar-local');

            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    updateConfirmButton();
                });
            });

            function updateConfirmButton() {
                const allChecked = Array.from(checkboxes).every(cb => cb.checked);
                confirmButton.disabled = !allChecked;
            }
        }

        function setupConfirmButton() {
            const confirmButton = document.getElementById('btn-confirmar-local');
            
            confirmButton.addEventListener('click', function() {
                if (this.disabled) return;
                
                // Mostrar loading
                this.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Confirmando...';
                this.disabled = true;
                
                // Simular processamento
                setTimeout(() => {
                    // Redirecionar para checkout
                    window.location.href = '/checkout';
                }, 2000);
            });
        }
    </script>
</body>
</html>